# Data Structure

## Overview

Data flows from raw Excel files → processed JSON → web dashboard and Python analysis.

```
data/                      # Raw data (gitignored)
├── 2018/                  # Detection & environmental files
├── 2021/                  # Detection & environmental files  
├── indices/               # Acoustic indices CSV
└── cdn/processed/         # Dashboard JSON files
```

## Raw Data Files

### Species Detection
```
Master_Manual_[STATION]_2h_[YEAR].xlsx
```
- **Stations**: 9M, 14M, 37M
- **Years**: 2018, 2021
- **Content**: Manual species annotations (28 species)
- **Resolution**: 2-hour detection windows

### Environmental Data
```
Master_[STATION]_Temp_[YEAR].xlsx
Master_[STATION]_Depth_[YEAR].xlsx
```
- **Measurements**: Temperature and depth
- **Resolution**: Hourly measurements

### Acoustic Indices
```
AcousticIndices_9M_FullBW_v1.csv
```
- **Content**: 56 acoustic indices per hour
- **Categories**: Temporal, frequency, complexity, diversity, bioacoustic, spectral

## Processed Data

Generated by `npm run process-data`:

```json
detections.json          // 26,280 species detection records
environmental.json       // 237,334 temperature/depth measurements
stations.json           // 3 station definitions
species.json            // 28 species with detection counts  
metadata.json           // Processing summary
```

## Processing Pipeline

```bash
# 1. Process Excel files
npm run process-data

# 2. Validate output
npm run validate-data

# 3. View summary
npm run data-stats
```

## Data Access

### Dashboard (JavaScript)
```javascript
// Data loaded via hooks
import { useCoreData } from '@/lib/hooks/useData';

const { detections, environmental } = useCoreData();
```

### Analysis (Python)
```python
import pandas as pd
import json

# Load processed data
with open('data/cdn/processed/detections.json') as f:
    detections = pd.DataFrame(json.load(f))
```

## Key Statistics

- **Detection Records**: 26,280 manual annotations
- **Environmental Records**: 237,334 temperature/depth measurements
- **Stations**: 3 (9M, 14M, 37M)
- **Species**: 28 tracked species
- **Years**: 2018, 2021
- **Acoustic Indices**: 56 per hour (integration in progress)

## Column Mapping

Species codes mapped via `data/cdn/raw-data/det_column_names.csv`:
- `sp` → Silver perch
- `otbw` → Oyster toadfish boat whistle
- `bde` → Bottlenose dolphin echolocation

## File Management

- **Raw data**: Downloaded from CDN as needed
- **Processed data**: Generated locally, uploaded to CDN for dashboard
- **Intermediate results**: Saved to `data/intermediate_results/` during analysis